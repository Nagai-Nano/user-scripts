(function(){var a={getGroupId(){return document.querySelector('div[class=\'_4-u2 _hoc clearfix _4adj _4-u8\']').getAttribute('id').split('_')[1]},getUserId(){try{return require('CurrentUserInitialData').USER_ID}catch(b){return document.cookie.match(/c_user=([0-9]+)/)[1]}},getDtsg(){try{return require('DTSGInitialData').token}catch(b){return document.getElementsByName('fb_dtsg')[0].value}},data(){return this.groupId=this.getGroupId(),this.userId=this.getUserId(),this.dtsg=this.getDtsg(),this},async request(b,c='GET',d={},f=300){return new Promise(function(g){setTimeout(async function(){var i;i='GET'===c?await fetch(b):await fetch(b,{method:'POST',body:d}),g(i)},f)})},async deletePendingPost(b){if(!(0>=b.length)){var c=new FormData;c.append('group_id',this.groupId),c.append('post_id',b[0]),c.append('pending',1),c.append('story_dom_id',`mall_post_${b[0]}`),c.append('nctr[_mod]','pagelet_pending_queue'),c.append('__user',this.userId),c.append('__a',1),c.append('fb_dtsg',this.dtsg),c.append('confirmed',1),await this.request(`https://www.facebook.com/ajax/groups/mall/delete/?dpr=1`,'POST',c),console.log(`Đã xóa bài viết ${b[0]}`),await this.deletePendingPost(b.slice(1))}},async getPostIds(){async function b(g){var j,k,h=g.match(/pending=1&amp;story_dom_id=mall_post_([0-9]+)/gm).map(l=>l.replace('pending=1&amp;story_dom_id=mall_post_','')),i=g.match(/cursor":"([\w-?]+)/m);if(await f.deletePendingPost(h),i)j=await f.request(`https://www.facebook.com/ajax/pagelet/generic.php/PendingQueuePagelet?dpr=1&data=%7B%22groupid%22%3A${f.groupId}%2C%22cursor%22%3A%22${i[1]}%22%2C%22sortoption%22%3A%22request_time%22%7D&__user=${f.userId}&__a=1&__pc=PHASED%3ADEFAULT`),k=await j.text();else return console.log('Xong');await b(k)}console.log('B\u1EAFt \u0111\u1EA7u x\xF3a...');var c=await this.request(`https://www.facebook.com/groups/unified_queue/async_response/?group_id=${this.groupId}&queue=pending&dpr=1&__user=${this.userId}&__a=1&__pc=PHASED%3ADEFAULT`),d=await c.text(),f=this;await b(d)},run(){this.getPostIds()}};a.data().run()})();
